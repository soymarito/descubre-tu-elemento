<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Descubre tu Elemento - Guía Interactiva</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f0f7ff;
            color: #333;
        }
        .accordion-item { border: 1px solid #dbeafe; border-radius: 8px; margin-bottom: 12px; background-color: white; overflow: hidden; }
        .accordion-header { background-color: #dbeafe; padding: 15px; cursor: pointer; font-weight: 600; transition: all 0.3s ease; display: flex; justify-content: space-between; align-items: center; }
        .accordion-header:hover { background-color: #bfdbfe; }
        .accordion-content { padding: 0; max-height: 0; overflow: hidden; transition: max-height 0.5s ease-out; }
        .accordion-content.active { max-height: 10000px; padding: 20px; transition: max-height 0.7s ease-in; }
        .section-title { margin-top: 20px; margin-bottom: 10px; font-weight: 600; color: #3b82f6; }
        textarea { resize: vertical; min-height: 80px; width: 100%; border-radius: 6px; border: 1px solid #bfdbfe; padding: 12px; margin-top: 6px; margin-bottom: 12px; transition: border-color 0.3s ease; }
        textarea:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2); }
        .btn { padding: 8px 15px; border-radius: 6px; font-weight: 500; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; justify-content: center; gap: 6px; margin-bottom: 8px; }
        .btn-primary { background-color: #3b82f6; color: white; }
        .btn-primary:hover { background-color: #2563eb; }
        .btn-secondary { background-color: #f3f4f6; color: #4b5563; border: 1px solid #d1d5db; }
        .btn-secondary:hover { background-color: #e5e7eb; }
        .btn-danger { background-color: #ef4444; color: white; }
        .btn-danger:hover { background-color: #dc2626; }
        .recording-indicator { color: #ef4444; display: none; font-size: 0.875rem; margin-left: 10px; animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        .save-indicator { color: #22c55e; opacity: 0; transition: opacity 0.3s ease; font-size: 0.875rem; position: fixed; bottom: 20px; right: 20px; background-color: white; padding: 8px 15px; border-radius: 6px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); z-index: 100; }
        .question-container { background-color: #f8fafc; padding: 15px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid #3b82f6; }
        #exportTextArea { min-height: 250px; background-color: #f3f4f6; font-family: monospace; white-space: pre-wrap; /* Para respetar saltos de línea en el prompt */ }
        .microphone-tooltip { display: block; font-size: 0.75rem; color: #6b7280; margin-top: 2px; margin-bottom: 10px; font-style: italic; }
        @media (max-width: 768px) { .container { padding-left: 16px; padding-right: 16px; } }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <header class="text-center mb-8">
            <h1 class="text-3xl font-bold text-blue-600">Guía Interactiva: Descubre tu Elemento</h1>
            <div class="mt-2 text-gray-600">
                <p>Por: Mario Espínola</p>
                <p class="text-sm italic">Inspirado en diversas experiencias y autores, tomando el concepto de 'El Elemento' de Sir Ken Robinson.</p>
            </div>
        </header>

        <div class="bg-white p-6 rounded-lg shadow mb-8">
            <h2 class="text-xl font-semibold mb-3">¿Qué es "El Elemento"?</h2>
            <p class="mb-4">
                Según Sir Ken Robinson, "El Elemento" es ese punto donde confluye lo que se te da bien (tus aptitudes naturales) y lo que amas hacer (tus pasiones). 
                Esta guía te ayudará a explorar tu propio "Elemento" a través de una serie de preguntas reflexivas.
            </p>
            <p class="text-sm bg-blue-50 p-3 rounded-md border-l-4 border-blue-500">
                <strong>Instrucciones Clave:</strong>
                <ol class="list-decimal list-inside ml-4 mt-2">
                    <li>Completa las Fases 1 y 2 de reflexión.</li>
                    <li>Usa el botón "<strong>Exportar para Análisis Inicial (Prompt 1)</strong>" y envía el texto generado a una Inteligencia Artificial (IA) de tu elección.</li>
                    <li>Pega el análisis que te proporcione la IA en el campo "Análisis Recibido de la IA" dentro de esta guía.</li>
                    <li>Con la nueva perspectiva del análisis, completa la Fase 3 (Planificación y Acción).</li>
                    <li>Finalmente, usa el botón "<strong>Exportar para Feedback de Planes (Prompt 2)</strong>" para obtener una revisión detallada de tus planes por la IA.</li>
                </ol>
                Tu progreso se guardará automáticamente en este navegador.
            </p>
            <div id="saveIndicator" class="save-indicator"><i class="fas fa-check-circle"></i> Progreso guardado</div>
        </div>

        <!-- Fase 1 (Contenido HTML de Fase 1) -->
        <div class="accordion-item">
            <div class="accordion-header" data-accordion="fase1">
                <span>Fase 1: Reflexión sobre el Pasado y el Presente</span>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </div>
            <div class="accordion-content" id="fase1">
                <h3 class="section-title">Recuerdos de la Infancia</h3>
                <div class="question-container"><label for="q1_1" class="font-medium block mb-1">1. ¿Qué actividades disfrutabas tanto de niño/a que perdías la noción del tiempo?</label><textarea id="q1_1" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_1"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_1"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q1_2" class="font-medium block mb-1">2. ¿Qué habilidades o destrezas te destacaban entre tus compañeros cuando eras niño/a?</label><textarea id="q1_2" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_2"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_2"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q1_3" class="font-medium block mb-1">3. ¿Qué sueños o aspiraciones tenías en tu infancia sobre lo que querías ser o hacer?</label><textarea id="q1_3" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_3"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_3"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <h3 class="section-title">Experiencias de Fluidez</h3>
                <div class="question-container"><label for="q1_4" class="font-medium block mb-1">1. ¿En qué actividades o tareas actuales pierdes la noción del tiempo cuando las realizas?</label><textarea id="q1_4" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_4"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_4"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q1_5" class="font-medium block mb-1">2. ¿Qué actividades te producen una sensación de satisfacción profunda al realizarlas?</label><textarea id="q1_5" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_5"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_5"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <h3 class="section-title">Fortalezas y Debilidades</h3>
                <div class="question-container"><label for="q1_6" class="font-medium block mb-1">1. ¿Qué habilidades o talentos te han reconocido otras personas?</label><textarea id="q1_6" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_6"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_6"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q1_7" class="font-medium block mb-1">2. ¿Qué tareas o actividades realizas con facilidad mientras que otros parecen esforzarse con ellas?</label><textarea id="q1_7" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_7"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_7"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q1_8" class="font-medium block mb-1">3. ¿En qué áreas sientes que tienes limitaciones o dificultades?</label><textarea id="q1_8" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q1_8"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q1_8"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
            </div>
        </div>

        <!-- Fase 2 (Contenido HTML de Fase 2) -->
        <div class="accordion-item">
            <div class="accordion-header" data-accordion="fase2">
                <span>Fase 2: Exploración y Apertura a Nuevas Posibilidades</span>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </div>
            <div class="accordion-content" id="fase2">
                <h3 class="section-title">Intereses y Curiosidades</h3>
                <div class="question-container"><label for="q2_1" class="font-medium block mb-1">1. ¿Qué temas o actividades te generan verdadera curiosidad?</label><textarea id="q2_1" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q2_1"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q2_1"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q2_2" class="font-medium block mb-1">2. ¿Qué contenidos (libros, videos, podcasts) consumes en tu tiempo libre?</label><textarea id="q2_2" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q2_2"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q2_2"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <h3 class="section-title">Valores y Propósito</h3>
                <div class="question-container"><label for="q2_3" class="font-medium block mb-1">1. ¿Qué valores son fundamentales en tu vida?</label><textarea id="q2_3" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q2_3"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q2_3"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q2_4" class="font-medium block mb-1">2. ¿Qué tipo de impacto te gustaría generar en tu entorno o en el mundo?</label><textarea id="q2_4" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q2_4"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q2_4"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <h3 class="section-title">Exploración de Posibilidades</h3>
                <div class="question-container"><label for="q2_5" class="font-medium block mb-1">1. ¿Qué profesiones, carreras o actividades has considerado que podrían alinearse con tus talentos y pasiones?</label><textarea id="q2_5" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q2_5"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q2_5"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q2_6" class="font-medium block mb-1">2. ¿Qué personas admiras y por qué? ¿Qué aspectos de sus carreras o vidas te resultan atractivos?</label><textarea id="q2_6" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q2_6"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q2_6"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
            </div>
        </div>

        <!-- Fase 3 (Contenido HTML de Fase 3) -->
         <div class="accordion-item">
            <div class="accordion-header" data-accordion="fase3">
                <span>Fase 3: Planificación y Acción</span>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </div>
            <div class="accordion-content" id="fase3">
                 <p class="text-sm bg-yellow-50 p-3 rounded-md border-l-4 border-yellow-500 mb-4">
                    <strong>Nota:</strong> Es recomendable completar esta fase después de haber reflexionado sobre el análisis inicial de la IA (obtenido con el Prompt 1).
                </p>
                <h3 class="section-title">Metas y Objetivos</h3>
                <div class="question-container"><label for="q3_1" class="font-medium block mb-1">1. ¿Qué metas a corto plazo (3-6 meses) podrías establecer para explorar tu "elemento"?</label><textarea id="q3_1" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q3_1"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q3_1"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q3_2" class="font-medium block mb-1">2. ¿Qué objetivos a mediano plazo (1-2 años) te gustaría alcanzar en relación con tu desarrollo personal o profesional?</label><textarea id="q3_2" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q3_2"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q3_2"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <h3 class="section-title">Plan de Acción</h3>
                <div class="question-container"><label for="q3_3" class="font-medium block mb-1">1. ¿Qué recursos (cursos, libros, mentores, herramientas) necesitas para avanzar hacia tus metas?</label><textarea id="q3_3" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q3_3"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q3_3"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q3_4" class="font-medium block mb-1">2. ¿Qué obstáculos prevés y cómo planeas superarlos?</label><textarea id="q3_4" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q3_4"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q3_4"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
                <div class="question-container"><label for="q3_5" class="font-medium block mb-1">3. ¿Cómo medirás tu progreso hacia tus metas?</label><textarea id="q3_5" rows="3" placeholder="Escribe tu respuesta aquí..."></textarea><button class="btn btn-secondary record-btn" data-target="q3_5"><i class="fas fa-microphone"></i> Grabar</button><span class="recording-indicator" id="recording-q3_5"><i class="fas fa-circle"></i> Grabando...</span><span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span></div>
            </div>
        </div>

        <!-- Análisis y Exportación - ACTUALIZADO SIN ANÁLISIS DE PALABRAS CLAVE Y CON DOS BOTONES -->
        <div class="accordion-item">
            <div class="accordion-header" data-accordion="analisis">
                <span>Análisis y Exportación</span>
                <i class="fas fa-chevron-down transition-transform duration-300"></i>
            </div>
            <div class="accordion-content" id="analisis">
                <h3 class="section-title">Tu Síntesis del "Elemento"</h3>
                <div class="question-container">
                    <label for="sintesis" class="font-medium block mb-1">A partir de todas tus reflexiones, ¿cómo describirías tu "Elemento"?</label>
                    <textarea id="sintesis" rows="5" placeholder="Escribe tu síntesis aquí..."></textarea>
                    <button class="btn btn-secondary record-btn" data-target="sintesis"><i class="fas fa-microphone"></i> Grabar Síntesis</button>
                    <span class="recording-indicator" id="recording-sintesis"><i class="fas fa-circle"></i> Grabando...</span>
                    <span class="microphone-tooltip">¿Prefieres hablar? Cuéntame como si hablaras con un amigo.</span>
                </div>
                
                <h3 class="section-title">Análisis Recibido de la IA (Opcional)</h3>
                <p class="text-sm text-gray-600 mb-3">Pega aquí el análisis de la IA sobre tus Fases 1 y 2. Esto se incluirá al exportar para el feedback de planes (Prompt 2).</p>
                <div class="question-container">
                    <label for="aiReceivedAnalysis" class="font-medium block mb-1">Respuesta/Análisis de la IA (sobre Fases 1 y 2):</label>
                    <textarea id="aiReceivedAnalysis" rows="8" placeholder="Pega aquí el análisis que te proporcionó la IA..."></textarea>
                </div>
                                
                <h3 class="section-title mt-6">Exportar para Análisis con IA</h3>
                <div class="mb-4">
                    <p class="text-sm text-gray-600 mb-2"><strong>Paso 1:</strong> Después de completar Fases 1 y 2 (y opcionalmente tu Síntesis), usa este botón para el análisis inicial:</p>
                    <button id="exportInitialAnalysisBtn" class="btn btn-primary w-full md:w-auto"><i class="fas fa-file-export"></i> Exportar para Análisis Inicial (Prompt 1)</button>
                </div>
                <div>
                    <p class="text-sm text-gray-600 mb-2"><strong>Paso 2:</strong> Después de completar la Fase 3 y haber pegado el análisis inicial de la IA (en el campo de arriba), usa este botón para obtener feedback sobre tus planes:</p>
                    <button id="exportPlanFeedbackBtn" class="btn btn-primary w-full md:w-auto"><i class="fas fa-file-export"></i> Exportar para Feedback de Planes (Prompt 2)</button>
                </div>
                
                <div id="exportArea" class="hidden mt-6">
                    <textarea id="exportTextArea" class="mb-4" readonly></textarea>
                    <button id="copyExportBtn" class="btn btn-secondary"><i class="fas fa-copy"></i> Copiar al Portapapeles</button>
                </div>
                
                <div id="promptsReference" class="bg-gray-50 p-4 rounded-md mt-6 hidden">
                    <h4 class="font-semibold mb-2">Prompts de Referencia (Estos se incluyen automáticamente en la exportación):</h4>
                    <div class="mb-3">
                        <p class="font-medium">Prompt 1 (Para Análisis Inicial):</p>
                        <p id="prompt1-text-ref" class="text-sm bg-white p-3 rounded border border-gray-200" style="white-space: pre-wrap;">Rol: Eres un coach experto en desarrollo personal y orientación vocacional con profunda experiencia en ayudar a las personas a identificar sus talentos innatos, pasiones auténticas y propósito de vida, inspirándote en conceptos como "El Elemento" de Sir Ken Robinson. Tu objetivo es analizar exhaustivamente las siguientes reflexiones personales para descubrir la esencia de mi "Elemento".

Tarea:
1.  **Análisis Detallado de Patrones y Conexiones:**
    *   Lee cuidadosamente todas mis respuestas de las Fases 1 (Reflexión sobre el Pasado y el Presente) y Fase 2 (Exploración y Apertura a Nuevas Posibilidades).
    *   Identifica temas recurrentes, palabras clave significativas, valores consistentemente mencionados, habilidades que emergen tanto de mis disfrutes pasados como de mis aptitudes actuales.
    *   Busca contradicciones aparentes o áreas de tensión que podrían revelar miedos o anhelos no expresados directamente.
    *   Conecta mis recuerdos de la infancia con mis experiencias actuales de fluidez y mis intereses declarados. ¿Qué hilos conductores observas?

2.  **Identificación de Talentos Naturales (Aptitudes):**
    *   Basándote en mis respuestas sobre actividades que realizo con facilidad, lo que otros reconocen en mí y mis propias percepciones, ¿cuáles parecen ser mis 3-5 talentos o aptitudes más destacadas? Sé específico (ej. "pensamiento analítico", "comunicación empática", "creatividad visual", "habilidad para organizar sistemas complejos", "destreza manual fina").

3.  **Identificación de Pasiones Genuinas (Intereses que Energizan):**
    *   Considerando las actividades donde pierdo la noción del tiempo, los temas que me generan curiosidad y lo que me produce satisfacción profunda, ¿cuáles son mis 2-4 pasiones o áreas de interés más intensas y auténticas?

4.  **Definición Preliminar de mi "Elemento":**
    *   Describe en 2-3 frases cómo podrías definir mi "Elemento" en este momento, es decir, la confluencia donde mis talentos naturales (punto 2) y mis pasiones genuinas (punto 3) parecen encontrarse de manera más potente.

5.  **Sugerencia de Caminos Potenciales (3-5 opciones):**
    *   Basándote en TODO el análisis anterior (patrones, talentos, pasiones, definición del "Elemento"), sugiere entre 3 y 5 caminos profesionales, roles, áreas de estudio o tipos de emprendimiento que parezcan particularmente alineados con lo que he expresado.
    *   Para CADA sugerencia, explica detalladamente:
        *   Por qué consideras que este camino se alinea con mi "Elemento" (menciona talentos y pasiones específicas de mi perfil que encajarían).
        *   Qué aspectos de mis respuestas respaldan esta sugerencia.
        *   Posibles desafíos o áreas de desarrollo a considerar si eligiera este camino, basándote en mis reflexiones.

6.  **Preguntas Adicionales para Profundizar (Opcional, si lo ves necesario):**
    *   Si identificas alguna área clave donde mis reflexiones son superficiales o contradictorias y que podría ser crucial explorar más, formula 1-2 preguntas específicas que me ayudarían a clarificar ese punto para un futuro análisis.

Formato de Respuesta Esperado:
Por favor, estructura tu respuesta de forma clara, utilizando encabezados para cada una de las 6 secciones anteriores. Sé profundo, empático y constructivo en tu análisis. Mi objetivo es obtener una comprensión clara y accionable de mi potencial.

A continuación, mis respuestas:</p>
                    </div>
                    <div>
                        <p class="font-medium">Prompt 2 (Para Feedback sobre Planes):</p>
                        <p id="prompt2-text-ref" class="text-sm bg-white p-3 rounded border border-gray-200" style="white-space: pre-wrap;">Rol: Eres un mentor y estratega de desarrollo profesional experimentado, con habilidad para evaluar planes de acción y ofrecer retroalimentación constructiva y específica. Ya has realizado un análisis inicial sobre mis talentos y pasiones (mi "Elemento"). Ahora, necesito tu perspectiva sobre mis planes concretos.

Contexto Previo (Incluido en los datos que te proporciono):
*   Mis reflexiones de Fase 1 (Pasado y Presente) y Fase 2 (Exploración).
*   El análisis inicial de IA que recibí sobre mi "Elemento" (si lo he incluido).
*   Mi propia "Síntesis del Elemento" (si la he incluido).

Tarea Principal: Análisis y Feedback de mis Planes de Acción (Fase 3)
Analiza en detalle mis respuestas de la Fase 3 (Metas y Objetivos, Plan de Acción, Recursos, Obstáculos, Medición de Progreso). Tu objetivo es evaluar la coherencia, viabilidad y potencial de estos planes en relación con todo el contexto previo.

Considera específicamente:
1.  **Alineación con el "Elemento":**
    *   ¿Mis metas y planes de acción (Fase 3) son coherentes y están bien alineados con los talentos, pasiones y la definición de mi "Elemento" identificados previamente (en Fases 1, 2, análisis de IA previo y mi síntesis)? Explica dónde ves una fuerte alineación y dónde podría haber desconexiones.

2.  **Viabilidad y Realismo de las Metas (SMART):**
    *   Evalúa mis metas a corto y mediano plazo. ¿Son Específicas, Medibles, Alcanzables, Relevantes y con Plazos definidos (SMART)?
    *   ¿Son realistas dado mi contexto actual (habilidades, recursos mencionados, posibles limitaciones)? ¿Son suficientemente ambiciosas para motivarme pero no tanto como para ser abrumadoras?

3.  **Robustez del Plan de Acción:**
    *   ¿Los recursos que he identificado son adecuados y suficientes? ¿Hay otros que podría considerar?
    *   ¿Mi identificación de obstáculos es completa? ¿Mis estrategias para superarlos son sólidas y proactivas? ¿Qué otros posibles obstáculos podría haber pasado por alto?
    *   ¿Mis métodos para medir el progreso son claros y efectivos?

4.  **Oportunidades No Consideradas o Puntos Ciegos:**
    *   Basándote en todo el material, ¿hay oportunidades, caminos alternativos o ajustes a mis planes que no estoy considerando y que podrían ser beneficiosos o estar mejor alineados con mi "Elemento"?
    *   ¿Identificas algún "punto ciego" en mi planificación o autoevaluación?

5.  **Sugerencias Específicas y Accionables para Refinar el Plan:**
    *   Proporciona de 3 a 5 sugerencias concretas y accionables para mejorar, refinar o fortalecer mi plan de acción (Fase 3). Estas sugerencias deben ser prácticas y ayudarme a maximizar mis posibilidades de éxito y satisfacción.

6.  **Fortalezas a Potenciar y Desafíos a Gestionar en la Ejecución:**
    *   ¿Qué fortalezas personales (identificadas en Fases 1 y 2) debería potenciar especialmente al ejecutar estos planes?
    *   ¿Qué posibles desafíos (basados en mis limitaciones o miedos expresados) debería tener especial cuidado en gestionar?

Formato de Respuesta Esperado:
Por favor, organiza tu feedback de manera clara, utilizando encabezados para cada uno de los 6 puntos anteriores. Tu tono debe ser el de un mentor constructivo, honesto y alentador. El objetivo es que yo pueda tomar mis planes actuales y llevarlos al siguiente nivel de efectividad.

Mis datos completos (Fases 1, 2, 3, análisis de IA previo, síntesis) están a continuación:</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="mt-8 text-center">
            <button id="clearAllBtn" class="btn btn-danger"><i class="fas fa-trash-alt"></i> Limpiar Todas las Respuestas</button>
        </div>
        
        <footer class="mt-12 text-center text-gray-500 text-sm">
            <p>© 2024 - Aplicación Web "Descubre tu Elemento" - Por Mario Espínola</p>
            <p class="mt-1">Inspirado en Sir Ken Robinson y otros.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const STORAGE_KEY = 'descubreTuElemento_v4_final'; // Updated key
            let recognition = null;
            let isRecording = false;
            let currentTextarea = null;

            // Accordion
            const accordionHeaders = document.querySelectorAll('.accordion-header');
            accordionHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = document.getElementById(header.dataset.accordion);
                    const isActive = content.classList.contains('active');
                    document.querySelectorAll('.accordion-content.active').forEach(activeContent => {
                        if (activeContent !== content) {
                            activeContent.classList.remove('active');
                            activeContent.previousElementSibling.querySelector('.fa-chevron-down').style.transform = 'rotate(0deg)';
                        }
                    });
                    content.classList.toggle('active');
                    header.querySelector('.fa-chevron-down').style.transform = content.classList.contains('active') ? 'rotate(180deg)' : 'rotate(0deg)';
                });
            });

            // Speech Recognition
            function checkSpeechRecognitionSupport() { return 'webkitSpeechRecognition' in window || 'SpeechRecognition' in window; }
            function initSpeechRecognition() {
                const SpeechRecognitionAPI = window.SpeechRecognition || window.webkitSpeechRecognition;
                if (!SpeechRecognitionAPI) return null;
                const instance = new SpeechRecognitionAPI();
                instance.lang = 'es-ES';
                instance.continuous = true;
                instance.interimResults = false;
                instance.onresult = event => {
                    let finalTranscript = '';
                    for (let i = event.resultIndex; i < event.results.length; ++i) {
                        if (event.results[i].isFinal) finalTranscript += event.results[i][0].transcript;
                    }
                    if (currentTextarea && finalTranscript) {
                        if (currentTextarea.value.trim().length > 0 && !currentTextarea.value.endsWith('\n\n') && !currentTextarea.value.endsWith(' ')) {
                             currentTextarea.value += currentTextarea.value.endsWith('\n') ? '\n' : '\n\n';
                        }
                        currentTextarea.value += finalTranscript.trim() + " ";
                        saveProgress();
                    }
                };
                instance.onerror = event => {
                    console.error('Speech recognition error', event.error, event.message);
                    let msg = 'Error en reconocimiento de voz.';
                    if (event.error === 'no-speech') msg = 'No se detectó voz.';
                    else if (event.error === 'audio-capture') msg = 'Problema con micrófono.';
                    else if (event.error === 'not-allowed') msg = 'Permiso de micrófono denegado.';
                    alert(msg);
                    if (isRecording) stopRecordingUI(document.querySelector(`.record-btn[data-target="${currentTextarea?.id}"]`) || null, !currentTextarea);
                };
                 instance.onend = () => {
                    if (isRecording) {
                        stopRecordingUI(document.querySelector(`.record-btn[data-target="${currentTextarea?.id}"]`) || null, !currentTextarea);
                    }
                };
                return instance;
            }
            function stopRecordingUI(buttonEl, forceAll = false) {
                isRecording = false;
                if (forceAll) {
                    document.querySelectorAll('.record-btn').forEach(btn => {
                        btn.innerHTML = '<i class="fas fa-microphone"></i> Grabar';
                        const indicator = document.getElementById(`recording-${btn.dataset.target}`);
                        if (indicator) indicator.style.display = 'none';
                    });
                } else if (buttonEl) {
                    buttonEl.innerHTML = '<i class="fas fa-microphone"></i> Grabar';
                    const indicator = document.getElementById(`recording-${buttonEl.dataset.target}`);
                    if (indicator) indicator.style.display = 'none';
                }
            }
            document.querySelectorAll('.record-btn').forEach(button => {
                button.addEventListener('click', function() {
                    if (!checkSpeechRecognitionSupport()) { alert('Grabación no soportada. Escribe o usa Chrome/Edge.'); return; }
                    currentTextarea = document.getElementById(this.dataset.target);
                    const recordingIndicator = document.getElementById(`recording-${this.dataset.target}`);
                    if (isRecording) {
                        if (recognition) recognition.stop();
                        stopRecordingUI(this); 
                    } else {
                        if (!recognition || (recognition.constructor.name === 'SpeechRecognition' && recognition.readyState === undefined)) { 
                            recognition = initSpeechRecognition();
                        }
                        if (!recognition) { alert("No se pudo inicializar grabación."); return; }
                        try {
                            recognition.start();
                            isRecording = true;
                            recordingIndicator.style.display = 'inline';
                            this.innerHTML = '<i class="fas fa-stop-circle"></i> Detener';
                        } catch (e) {
                            alert("Error al iniciar grabación: " + e.message);
                            stopRecordingUI(this);
                        }
                    }
                });
            });

            // Autosave
            const allTextareas = document.querySelectorAll('textarea');
            let saveTimeout;
            allTextareas.forEach(textarea => {
                textarea.addEventListener('input', () => {
                    clearTimeout(saveTimeout);
                    saveTimeout = setTimeout(saveProgress, 1000);
                });
            });
            function saveProgress() {
                const saveData = {};
                allTextareas.forEach(ta => saveData[ta.id] = ta.value);
                localStorage.setItem(STORAGE_KEY, JSON.stringify(saveData));
                const indicator = document.getElementById('saveIndicator');
                indicator.style.opacity = '1';
                setTimeout(() => indicator.style.opacity = '0', 2000);
            }
            function loadProgress() {
                const savedData = localStorage.getItem(STORAGE_KEY);
                if (savedData) {
                    const data = JSON.parse(savedData);
                    for (const id in data) {
                        const ta = document.getElementById(id);
                        if (ta) ta.value = data[id];
                    }
                }
            }
            loadProgress();

            // Helper to get question value
            function getQuestionValue(id, defaultValue = 'Sin respuesta') { 
                const el = document.getElementById(id);
                return el && el.value ? el.value.trim() : defaultValue;
            }
            
            function buildBaseExportText() { // For Fases 1, 2 and Sintesis
                let text = "## FASE 1: REFLEXIÓN SOBRE EL PASADO Y EL PRESENTE\n\n";
                text += "### Recuerdos de la Infancia\n";
                text += `1. Actividades de niño/a donde perdías noción del tiempo: ${getQuestionValue('q1_1')}\n`;
                text += `2. Habilidades destacadas de niño/a: ${getQuestionValue('q1_2')}\n`;
                text += `3. Sueños de infancia: ${getQuestionValue('q1_3')}\n\n`;
                text += "### Experiencias de Fluidez\n";
                text += `1. Actividades actuales donde pierdes noción del tiempo: ${getQuestionValue('q1_4')}\n`;
                text += `2. Actividades de satisfacción profunda: ${getQuestionValue('q1_5')}\n\n`;
                text += "### Fortalezas y Debilidades\n";
                text += `1. Habilidades/talentos reconocidos: ${getQuestionValue('q1_6')}\n`;
                text += `2. Tareas realizadas con facilidad vs otros: ${getQuestionValue('q1_7')}\n`;
                text += `3. Áreas de limitaciones/dificultades: ${getQuestionValue('q1_8')}\n\n`;

                text += "## FASE 2: EXPLORACIÓN Y APERTURA A NUEVAS POSIBILIDADES\n\n";
                text += "### Intereses y Curiosidades\n";
                text += `1. Temas/actividades de curiosidad: ${getQuestionValue('q2_1')}\n`;
                text += `2. Contenidos consumidos en tiempo libre: ${getQuestionValue('q2_2')}\n\n`;
                text += "### Valores y Propósito\n";
                text += `1. Valores fundamentales: ${getQuestionValue('q2_3')}\n`;
                text += `2. Impacto deseado en el entorno/mundo: ${getQuestionValue('q2_4')}\n\n`;
                text += "### Exploración de Posibilidades\n";
                text += `1. Profesiones/carreras consideradas: ${getQuestionValue('q2_5')}\n`;
                text += `2. Personas admiradas y por qué: ${getQuestionValue('q2_6')}\n\n`;
                
                const sintesisText = getQuestionValue('sintesis', '');
                if (sintesisText && sintesisText !== 'Sin respuesta') {
                     text += "## MI SÍNTESIS DEL \"ELEMENTO\"\n\n";
                     text += `${sintesisText}\n\n`;
                }
                return text;
            }

            // Export Functions
            document.getElementById('exportInitialAnalysisBtn').addEventListener('click', () => {
                const prompt1 = document.getElementById('prompt1-text-ref').textContent; // No trim here, preserve formatting
                let exportText = prompt1 + "\n\n"; // Prompt 1
                exportText += "--- MIS RESPUESTAS (FASES 1, 2 Y SÍNTESIS SI EXISTE) ---\n\n";
                exportText += buildBaseExportText();
                displayAndCopyExportText(exportText, "Texto para análisis inicial copiado. Pégalo en la IA.");
            });

            document.getElementById('exportPlanFeedbackBtn').addEventListener('click', () => {
                const prompt2 = document.getElementById('prompt2-text-ref').textContent; // No trim here
                let exportText = prompt2 + "\n\n"; // Prompt 2
                exportText += "--- MIS DATOS COMPLETOS PARA FEEDBACK DE PLANES ---\n\n";
                exportText += buildBaseExportText(); // F1, F2, Sintesis

                const aiAnalysis = getQuestionValue('aiReceivedAnalysis', '');
                if (aiAnalysis && aiAnalysis !== 'Sin respuesta') {
                    exportText += "## ANÁLISIS PREVIO RECIBIDO DE LA IA (SOBRE FASES 1 Y 2)\n\n";
                    exportText += `${aiAnalysis.trim()}\n\n`;
                } else {
                     exportText += "## ANÁLISIS PREVIO RECIBIDO DE LA IA (SOBRE FASES 1 Y 2)\n\n(No se proporcionó análisis previo de IA o no fue pegado en la guía)\n\n";
                }

                exportText += "## FASE 3: PLANIFICACIÓN Y ACCIÓN\n\n";
                exportText += "### Metas y Objetivos\n";
                exportText += `1. Metas a corto plazo (3-6 meses): ${getQuestionValue('q3_1')}\n`;
                exportText += `2. Objetivos a mediano plazo (1-2 años): ${getQuestionValue('q3_2')}\n\n`;
                exportText += "### Plan de Acción\n";
                exportText += `1. Recursos necesarios: ${getQuestionValue('q3_3')}\n`;
                exportText += `2. Obstáculos previstos y cómo superarlos: ${getQuestionValue('q3_4')}\n`;
                exportText += `3. Medición de progreso: ${getQuestionValue('q3_5')}\n\n`;
                
                const sintesisTextFinal = getQuestionValue('sintesis', '');
                 if (sintesisTextFinal && sintesisTextFinal !== 'Sin respuesta' && !exportText.includes("## MI SÍNTESIS DEL \"ELEMENTO\"")) {
                     exportText += "## MI SÍNTESIS DEL \"ELEMENTO\"\n\n";
                     exportText += `${sintesisTextFinal}\n\n`;
                }
                displayAndCopyExportText(exportText, "Texto para feedback de planes copiado. Pégalo en la IA.");
            });
            
            function displayAndCopyExportText(textToExport, alertMessage) {
                const exportAreaDiv = document.getElementById('exportArea');
                const exportTextAreaEl = document.getElementById('exportTextArea');
                exportTextAreaEl.value = textToExport;
                exportAreaDiv.classList.remove('hidden');
                document.getElementById('promptsReference').classList.remove('hidden'); 
                try {
                    navigator.clipboard.writeText(textToExport)
                        .then(() => alert(alertMessage))
                        .catch(err => {
                            alert('Copia automática falló. Usa el botón "Copiar" o copia manualmente.');
                        });
                } catch (e) {
                    alert('Error al copiar. Usa el botón "Copiar" o copia manually.');
                }
            }
            document.getElementById('copyExportBtn').addEventListener('click', function() {
                const ta = document.getElementById('exportTextArea');
                ta.select(); ta.setSelectionRange(0, 99999);
                try {
                    navigator.clipboard.writeText(ta.value)
                        .then(() => alert('Texto copiado al portapapeles.'))
                        .catch(err => { 
                            if (document.execCommand('copy')) {
                                alert('Texto copiado (método alternativo).');
                            } else {
                                alert('No se pudo copiar. Selecciona y Ctrl+C.');
                            }
                        });
                } catch (e) {
                     try {
                        if (document.execCommand('copy')) {
                             alert('Texto copiado (método alternativo).');
                        } else {alert('No se pudo copiar. Selecciona y Ctrl+C.');}
                    } catch (ex) {alert('No se pudo copiar. Selecciona y Ctrl+C.');}
                }
            });

            // Clear All
            document.getElementById('clearAllBtn').addEventListener('click', () => {
                if (confirm('¿Borrar TODAS tus respuestas y análisis de IA? ESTO NO SE PUEDE DESHACER.')) {
                    allTextareas.forEach(ta => ta.value = '');
                    localStorage.removeItem(STORAGE_KEY);
                    document.getElementById('exportArea').classList.add('hidden');
                    document.getElementById('exportTextArea').value = '';
                    document.getElementById('promptsReference').classList.add('hidden');
                    alert('Todo borrado.');
                }
            });
            if (!checkSpeechRecognitionSupport()) {
                document.querySelectorAll('.record-btn').forEach(b => { b.disabled = true; b.title = "Grabación no compatible.";});
                document.querySelectorAll('.microphone-tooltip').forEach(t => t.textContent = "Grabación no disponible.");
            }
        });
    </script>
</body>
</html>
